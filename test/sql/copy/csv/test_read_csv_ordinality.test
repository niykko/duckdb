# name: test/sql/copy/csv/test_read_csv_ordinality.test
# description: Test read CSV function with "with ordinality"
# group: [csv]

# name: test/sql/copy/csv/test_read_csv.test
# description: Test read CSV function
# group: [csv]

# test if read_csv:
#	- continues to count correctly when vector is full
#	- continues to count from correct index when new file is read
#mode output_hash

query IIII nosort auto
select * from read_csv_auto(['test/sql/copy/csv/data/test/ordinality_test_over_vector1.csv', 'test/sql/copy/csv/data/test/ordinality_test_over_vector2.csv'], header=true) with ordinality;
----
20008 values hashing to aa9b9bfb4098069b97ba532ec56f226d

query IIII nosort nonauto
select * from read_csv(['test/sql/copy/csv/data/test/ordinality_test_over_vector1.csv', 'test/sql/copy/csv/data/test/ordinality_test_over_vector2.csv'], auto_detect=true, header=true) with ordinality;
----
20008 values hashing to aa9b9bfb4098069b97ba532ec56f226d